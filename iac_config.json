{
  "SchemaVersion": 2,
  "CreatedAt": "2025-06-03T21:31:09.161189+07:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": "azure-arm/template.json",
      "Class": "config",
      "Type": "azure-arm",
      "MisconfSummary": {
        "Successes": 19,
        "Failures": 15
      },
      "Misconfigurations": [
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0001",
          "AVDID": "AVD-AZU-0001",
          "Title": "Web App accepts incoming client certificate",
          "Description": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.\n",
          "Message": "App service does not have client certificates enabled.",
          "Namespace": "builtin.azure.appservice.azure0001",
          "Query": "data.builtin.azure.appservice.azure0001.deny",
          "Resolution": "Enable incoming certificates for clients",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0001",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 338,
            "EndLine": 360,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 338,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 339,
                  "Content": "        \"serverFarmId\": \"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"serverFarmId\"\u001b[0m: \u001b[38;5;37m\"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 341,
                  "Content": "        \"clientAffinityEnabled\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"clientAffinityEnabled\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 342,
                  "Content": "        \"siteConfig\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"siteConfig\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 343,
                  "Content": "          \"minTlsVersion\": \"1.0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"minTlsVersion\"\u001b[0m: \u001b[38;5;37m\"1.0\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "          \"ftpsState\": \"AllAllowed\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"ftpsState\"\u001b[0m: \u001b[38;5;37m\"AllAllowed\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 345,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0002",
          "AVDID": "AVD-AZU-0002",
          "Title": "Web App has registration with AD enabled",
          "Description": "Registering the identity used by an App with AD allows it to interact with other services without using username and password\n",
          "Message": "App service does not have an identity type.",
          "Namespace": "builtin.azure.appservice.azure0002",
          "Query": "data.builtin.azure.appservice.azure0002.deny",
          "Resolution": "Register the app identity with AD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0002",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 338,
            "EndLine": 360,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 338,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 339,
                  "Content": "        \"serverFarmId\": \"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"serverFarmId\"\u001b[0m: \u001b[38;5;37m\"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 341,
                  "Content": "        \"clientAffinityEnabled\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"clientAffinityEnabled\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 342,
                  "Content": "        \"siteConfig\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"siteConfig\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 343,
                  "Content": "          \"minTlsVersion\": \"1.0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"minTlsVersion\"\u001b[0m: \u001b[38;5;37m\"1.0\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "          \"ftpsState\": \"AllAllowed\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"ftpsState\"\u001b[0m: \u001b[38;5;37m\"AllAllowed\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 345,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0003",
          "AVDID": "AVD-AZU-0003",
          "Title": "App Service authentication is activated",
          "Description": "Enabling authentication ensures that all communications in the application are authenticated. The auth_settings block needs to be filled out with the appropriate auth backend settings\n",
          "Message": "App service does not have authentication enabled.",
          "Namespace": "builtin.azure.appservice.azure0003",
          "Query": "data.builtin.azure.appservice.azure0003.deny",
          "Resolution": "Enable authentication to prevent anonymous request being accepted",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0003",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 338,
            "EndLine": 360,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 338,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 339,
                  "Content": "        \"serverFarmId\": \"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"serverFarmId\"\u001b[0m: \u001b[38;5;37m\"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 341,
                  "Content": "        \"clientAffinityEnabled\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"clientAffinityEnabled\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 342,
                  "Content": "        \"siteConfig\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"siteConfig\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 343,
                  "Content": "          \"minTlsVersion\": \"1.0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"minTlsVersion\"\u001b[0m: \u001b[38;5;37m\"1.0\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "          \"ftpsState\": \"AllAllowed\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"ftpsState\"\u001b[0m: \u001b[38;5;37m\"AllAllowed\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 345,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0004",
          "AVDID": "AVD-AZU-0004",
          "Title": "Ensure the Function App can only be accessed via HTTPS. The default is false.",
          "Description": "By default, clients can connect to function endpoints by using both HTTP or HTTPS. You should redirect HTTP to HTTPs because HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated.\n",
          "Message": "Function app does not have HTTPS enforced.",
          "Namespace": "builtin.azure.appservice.azure0004",
          "Query": "data.builtin.azure.appservice.azure0004.deny",
          "Resolution": "You can redirect all HTTP requests to the HTTPS port.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0004",
          "References": [
            "https://docs.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https",
            "https://docs.microsoft.com/en-us/azure/azure-functions/security-concepts",
            "https://avd.aquasec.com/misconfig/avd-azu-0004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 340,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 338,
                  "EndLine": 360
                }
              },
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0005",
          "AVDID": "AVD-AZU-0005",
          "Title": "Web App uses the latest HTTP version",
          "Description": "Use the latest version of HTTP to ensure you are benefiting from security fixes\n",
          "Message": "App service does not have HTTP/2 enabled.",
          "Namespace": "builtin.azure.appservice.azure0005",
          "Query": "data.builtin.azure.appservice.azure0005.deny",
          "Resolution": "Use the latest version of HTTP",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0005",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 340,
            "EndLine": 340,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 338,
                  "EndLine": 360
                }
              },
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0006",
          "AVDID": "AVD-AZU-0006",
          "Title": "Web App uses latest TLS version",
          "Description": "Use a more recent TLS/SSL policy for the App Service\n",
          "Message": "App service does not require a secure TLS version.",
          "Namespace": "builtin.azure.appservice.azure0006",
          "Query": "data.builtin.azure.appservice.azure0006.deny",
          "Resolution": "The TLS version being outdated and has known vulnerabilities",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0006",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0006"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 338,
            "EndLine": 360,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 338,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 339,
                  "Content": "        \"serverFarmId\": \"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"serverFarmId\"\u001b[0m: \u001b[38;5;37m\"[resourceId('Microsoft.Web/serverfarms', 'myAppServicePlan')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 340,
                  "Content": "        \"httpsOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"httpsOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 341,
                  "Content": "        \"clientAffinityEnabled\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"clientAffinityEnabled\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 342,
                  "Content": "        \"siteConfig\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"siteConfig\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 343,
                  "Content": "          \"minTlsVersion\": \"1.0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"minTlsVersion\"\u001b[0m: \u001b[38;5;37m\"1.0\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 344,
                  "Content": "          \"ftpsState\": \"AllAllowed\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"ftpsState\"\u001b[0m: \u001b[38;5;37m\"AllAllowed\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 345,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[10]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 330,
                  "EndLine": 361
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0008",
          "AVDID": "AVD-AZU-0008",
          "Title": "Storage accounts should be configured to only accept transfers that are over secure connections",
          "Description": "You can configure your storage account to accept requests from secure connections only by setting the Secure transfer required property for the storage account.\nWhen you require secure transfer, any requests originating from an insecure connection are rejected.\nMicrosoft recommends that you always require secure transfer for all of your storage accounts.\n",
          "Message": "Account does not enforce HTTPS.",
          "Namespace": "builtin.azure.storage.azure0008",
          "Query": "data.builtin.azure.storage.azure0008.deny",
          "Resolution": "Only allow secure connection for transferring data into storage accounts",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0008",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-require-secure-transfer",
            "https://avd.aquasec.com/misconfig/avd-azu-0008"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 51,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        \"supportsHttpsTrafficOnly\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"supportsHttpsTrafficOnly\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[0].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 50,
                  "EndLine": 67
                }
              },
              {
                "Resource": "resources[0]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 41,
                  "EndLine": 68
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0010",
          "AVDID": "AVD-AZU-0010",
          "Title": "Trusted Microsoft Services should have bypass access to Storage accounts",
          "Description": "Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules.\nTo help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules\n",
          "Message": "Network rules do not allow bypass for Microsoft Services.",
          "Namespace": "builtin.azure.storage.azure0010",
          "Query": "data.builtin.azure.storage.azure0010.deny",
          "Resolution": "Allow Trusted Microsoft Services to bypass",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0010",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security#trusted-microsoft-services",
            "https://avd.aquasec.com/misconfig/avd-azu-0010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 54,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        \"networkAcls\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"networkAcls\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "          \"defaultAction\": \"Allow\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"defaultAction\"\u001b[0m: \u001b[38;5;37m\"Allow\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "        },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        },",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[0].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 50,
                  "EndLine": 67
                }
              },
              {
                "Resource": "resources[0]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 41,
                  "EndLine": 68
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0011",
          "AVDID": "AVD-AZU-0011",
          "Title": "The minimum TLS version for Storage Accounts should be TLS1_2",
          "Description": "Azure Storage currently supports three versions of the TLS protocol: 1.0, 1.1, and 1.2.\nAzure Storage uses TLS 1.2 on public HTTPS endpoints, but TLS 1.0 and TLS 1.1 are still supported for backward compatibility.\nThis check will warn if the minimum TLS is not set to TLS1_2.\n",
          "Message": "Storage account uses an insecure TLS version.",
          "Namespace": "builtin.azure.storage.azure0011",
          "Query": "data.builtin.azure.storage.azure0011.deny",
          "Resolution": "Use a more recent TLS/SSL policy for the load balancer",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0011",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/transport-layer-security-configure-minimum-version",
            "https://avd.aquasec.com/misconfig/avd-azu-0011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 53,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        \"minimumTlsVersion\": \"TLS1_0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"minimumTlsVersion\"\u001b[0m: \u001b[38;5;37m\"TLS1_0\"\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[0].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 50,
                  "EndLine": 67
                }
              },
              {
                "Resource": "resources[0]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 41,
                  "EndLine": 68
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0012",
          "AVDID": "AVD-AZU-0012",
          "Title": "The default action on Storage account network rules should be set to deny",
          "Description": "The default_action for network rules should come into effect when no other rules are matched.\nThe default action should be set to Deny.\n",
          "Message": "Network rules allow access by default.",
          "Namespace": "builtin.azure.storage.azure0012",
          "Query": "data.builtin.azure.storage.azure0012.deny",
          "Resolution": "Set network rules to deny",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0012",
          "References": [
            "https://docs.microsoft.com/en-us/azure/firewall/rule-processing",
            "https://avd.aquasec.com/misconfig/avd-azu-0012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 54,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        \"networkAcls\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"networkAcls\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "          \"defaultAction\": \"Allow\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"defaultAction\"\u001b[0m: \u001b[38;5;37m\"Allow\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "        },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        },",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[0].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 50,
                  "EndLine": 67
                }
              },
              {
                "Resource": "resources[0]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 41,
                  "EndLine": 68
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0013",
          "AVDID": "AVD-AZU-0013",
          "Title": "Key vault should have the network acl block specified",
          "Description": "Network ACLs allow you to reduce your exposure to risk by limiting what can access your key vault.\n\nThe default action of the Network ACL should be set to deny for when IPs are not matched. Azure services can be allowed to bypass.\n",
          "Message": "Vault network ACL does not block access by default.",
          "Namespace": "builtin.azure.keyvault.azure0013",
          "Query": "data.builtin.azure.keyvault.azure0013.deny",
          "Resolution": "Set a network ACL for the key vault",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0013",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/general/network-security",
            "https://avd.aquasec.com/misconfig/avd-azu-0013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 286,
            "EndLine": 318,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 286,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 287,
                  "Content": "      \"type\": \"Microsoft.KeyVault/vaults\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"type\"\u001b[0m: \u001b[38;5;37m\"Microsoft.KeyVault/vaults\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 288,
                  "Content": "      \"apiVersion\": \"2021-04-01-preview\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"apiVersion\"\u001b[0m: \u001b[38;5;37m\"2021-04-01-preview\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 289,
                  "Content": "      \"name\": \"[concat('keyvault', uniqueString(resourceGroup().id))]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"name\"\u001b[0m: \u001b[38;5;37m\"[concat('keyvault', uniqueString(resourceGroup().id))]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 290,
                  "Content": "      \"location\": \"[resourceGroup().location]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"location\"\u001b[0m: \u001b[38;5;37m\"[resourceGroup().location]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 291,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 292,
                  "Content": "        \"sku\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"sku\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 293,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0016",
          "AVDID": "AVD-AZU-0016",
          "Title": "Key vault should have purge protection enabled",
          "Description": "Purge protection is an optional Key Vault behavior and is not enabled by default.\n\nPurge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI or PowerShell.\n",
          "Message": "Vault does not have purge protection enabled.",
          "Namespace": "builtin.azure.keyvault.azure0016",
          "Query": "data.builtin.azure.keyvault.azure0016.deny",
          "Resolution": "Enable purge protection for key vaults",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0016",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/general/soft-delete-overview#purge-protection",
            "https://avd.aquasec.com/misconfig/avd-azu-0016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 312,
            "EndLine": 312,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 312,
                  "Content": "        \"enablePurgeProtection\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"enablePurgeProtection\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 380,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 381,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources[8].properties",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 291,
                  "EndLine": 317
                }
              },
              {
                "Resource": "resources[8]",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 286,
                  "EndLine": 318
                }
              },
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0022",
          "AVDID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.\n",
          "Message": "Database server has public network access enabled.",
          "Namespace": "builtin.azure.database.azure0022",
          "Query": "data.builtin.azure.database.azure0022.deny",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 245,
            "EndLine": 285,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "      \"type\": \"Microsoft.Sql/servers\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"type\"\u001b[0m: \u001b[38;5;37m\"Microsoft.Sql/servers\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "      \"apiVersion\": \"2021-02-01-preview\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"apiVersion\"\u001b[0m: \u001b[38;5;37m\"2021-02-01-preview\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "      \"name\": \"[variables('databaseServerName')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"name\"\u001b[0m: \u001b[38;5;37m\"[variables('databaseServerName')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 249,
                  "Content": "      \"location\": \"[resourceGroup().location]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"location\"\u001b[0m: \u001b[38;5;37m\"[resourceGroup().location]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "        \"administratorLogin\": \"sqladmin\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"administratorLogin\"\u001b[0m: \u001b[38;5;37m\"sqladmin\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 252,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0026",
          "AVDID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.\n",
          "Message": "Database server does not require a secure TLS version.",
          "Namespace": "builtin.azure.database.azure0026",
          "Query": "data.builtin.azure.database.azure0026.deny",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 245,
            "EndLine": 285,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "      \"type\": \"Microsoft.Sql/servers\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"type\"\u001b[0m: \u001b[38;5;37m\"Microsoft.Sql/servers\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "      \"apiVersion\": \"2021-02-01-preview\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"apiVersion\"\u001b[0m: \u001b[38;5;37m\"2021-02-01-preview\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "      \"name\": \"[variables('databaseServerName')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"name\"\u001b[0m: \u001b[38;5;37m\"[variables('databaseServerName')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 249,
                  "Content": "      \"location\": \"[resourceGroup().location]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"location\"\u001b[0m: \u001b[38;5;37m\"[resourceGroup().location]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "        \"administratorLogin\": \"sqladmin\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"administratorLogin\"\u001b[0m: \u001b[38;5;37m\"sqladmin\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 252,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Azure ARM Security Check",
          "ID": "AVD-AZU-0027",
          "AVDID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.\n",
          "Message": "Server does not have an extended audit policy configured.",
          "Namespace": "builtin.azure.database.azure0027",
          "Query": "data.builtin.azure.database.azure0027.deny",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 245,
            "EndLine": 285,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "{",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "{",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "      \"type\": \"Microsoft.Sql/servers\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"type\"\u001b[0m: \u001b[38;5;37m\"Microsoft.Sql/servers\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "      \"apiVersion\": \"2021-02-01-preview\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"apiVersion\"\u001b[0m: \u001b[38;5;37m\"2021-02-01-preview\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "      \"name\": \"[variables('databaseServerName')]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"name\"\u001b[0m: \u001b[38;5;37m\"[variables('databaseServerName')]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 249,
                  "Content": "      \"location\": \"[resourceGroup().location]\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"location\"\u001b[0m: \u001b[38;5;37m\"[resourceGroup().location]\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "      \"properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 251,
                  "Content": "        \"administratorLogin\": \"sqladmin\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"administratorLogin\"\u001b[0m: \u001b[38;5;37m\"sqladmin\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 252,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "resources",
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 40,
                  "EndLine": 362
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {
                  "StartLine": 1,
                  "EndLine": 381
                }
              },
              {
                "Filename": "azure-arm/template.json",
                "Location": {}
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "cloudformation/template.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 37,
        "Failures": 28
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0014",
          "AVDID": "AVD-AWS-0014",
          "Title": "Cloudtrail should be enabled in all regions regardless of where your AWS resources are generally homed",
          "Description": "Activity could be happening in your account in a different region. When creating Cloudtrail in the AWS Management Console the trail is configured by default to be multi-region, this isn't the case with the Terraform resource. Cloudtrail should cover the full AWS account to ensure you can track changes in regions you are not actively operating in.\n",
          "Message": "Trail is not enabled across all regions.",
          "Namespace": "builtin.aws.cloudtrail.aws0014",
          "Query": "data.builtin.aws.cloudtrail.aws0014.deny",
          "Resolution": "Enable Cloudtrail in all regions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0014",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "CloudTrail",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 128,
            "EndLine": 128,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "    \"CloudTrail\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"CloudTrail\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      \"Type\": \"AWS::CloudTrail::Trail\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "      \"Properties\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "        \"TrailName\": \"trivy-test-trail\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"TrailName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "        \"S3BucketName\": {\"Ref\": \"S3BucketWithLogging\"},",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"S3BucketName\"\u001b[0m: {\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m},",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        \"IncludeGlobalServiceEvents\": true,",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IncludeGlobalServiceEvents\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "        \"IsMultiRegionTrail\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IsMultiRegionTrail\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 129,
                  "Content": "        \"EnableLogFileValidation\": false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EnableLogFileValidation\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "      }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    }",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "CloudTrail",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 122,
                  "EndLine": 131
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0015",
          "AVDID": "AVD-AWS-0015",
          "Title": "CloudTrail should use Customer managed keys to encrypt the logs",
          "Description": "Using AWS managed keys does not allow for fine grained control.  Using Customer managed keys provides comprehensive control over cryptographic keys, enabling management of policies, permissions, and rotation, thus enhancing security and compliance measures for sensitive data and systems.\n",
          "Message": "CloudTrail does not use a customer managed key to encrypt the logs.",
          "Namespace": "builtin.aws.cloudtrail.aws0015",
          "Query": "data.builtin.aws.cloudtrail.aws0015.deny",
          "Resolution": "Use Customer managed key",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0015",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html",
            "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#key-mgmt",
            "https://avd.aquasec.com/misconfig/avd-aws-0015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:122-131",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 122,
            "EndLine": 131,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "    \"CloudTrail\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"CloudTrail\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      \"Type\": \"AWS::CloudTrail::Trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "        \"TrailName\": \"trivy-test-trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"TrailName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "        \"S3BucketName\": {\"Ref\": \"S3BucketWithLogging\"},",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"S3BucketName\"\u001b[0m: {\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m},",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        \"IncludeGlobalServiceEvents\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IncludeGlobalServiceEvents\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "        \"IsMultiRegionTrail\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IsMultiRegionTrail\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "        \"EnableLogFileValidation\": false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EnableLogFileValidation\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "      }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    }",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0016",
          "AVDID": "AVD-AWS-0016",
          "Title": "Cloudtrail log validation should be enabled to prevent tampering of log data",
          "Description": "Illicit activity could be removed from the logs. Log validation should be activated on Cloudtrail logs to prevent the tampering of the underlying data in the S3 bucket. It is feasible that a rogue actor compromising an AWS account might want to modify the log data to remove trace of their actions.\n",
          "Message": "Trail does not have log validation enabled.",
          "Namespace": "builtin.aws.cloudtrail.aws0016",
          "Query": "data.builtin.aws.cloudtrail.aws0016.deny",
          "Resolution": "Turn on log validation for Cloudtrail",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0016",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-intro.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "CloudTrail",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 129,
            "EndLine": 129,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "    \"CloudTrail\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"CloudTrail\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      \"Type\": \"AWS::CloudTrail::Trail\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "      \"Properties\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "        \"TrailName\": \"trivy-test-trail\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"TrailName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "        \"S3BucketName\": {\"Ref\": \"S3BucketWithLogging\"},",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"S3BucketName\"\u001b[0m: {\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m},",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        \"IncludeGlobalServiceEvents\": true,",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IncludeGlobalServiceEvents\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "        \"IsMultiRegionTrail\": false,",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IsMultiRegionTrail\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "        \"EnableLogFileValidation\": false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EnableLogFileValidation\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 130,
                  "Content": "      }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    }",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "CloudTrail",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 122,
                  "EndLine": 131
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:28-56",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 28,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "    \"WebServerInstance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerInstance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "      \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        \"ImageId\": \"ami-0c94855ba95b798c7\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-0c94855ba95b798c7\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        \"InstanceType\": \"t2.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t2.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "        \"KeyName\": {\"Ref\": \"KeyPairName\"},",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"KeyName\"\u001b[0m: {\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"KeyPairName\"\u001b[0m},",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        \"SecurityGroupIds\": [{\"Ref\": \"WebServerSecurityGroup\"}],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [{\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m}],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        \"UserData\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"UserData\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "          \"Fn::Base64\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"Fn::Base64\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0077",
          "AVDID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.\n",
          "Message": "Instance has very low backup retention period.",
          "Namespace": "builtin.aws.rds.aws0077",
          "Query": "data.builtin.aws.rds.aws0077.deny",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "DatabaseInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 103,
            "EndLine": 103,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "        \"BackupRetentionPeriod\": 0,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"BackupRetentionPeriod\"\u001b[0m: \u001b[38;5;37m0\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "DatabaseInstance",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 91,
                  "EndLine": 107
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0080",
          "AVDID": "AVD-AWS-0080",
          "Title": "RDS encryption has not been enabled at a DB Instance level.",
          "Description": "Encryption should be enabled for an RDS Database instances.\nWhen enabling encryption by setting the kms_key_id.\n",
          "Message": "Instance does not have storage encryption enabled.",
          "Namespace": "builtin.aws.rds.aws0080",
          "Query": "data.builtin.aws.rds.aws0080.deny",
          "Resolution": "Enable encryption for RDS instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0080",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0080"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "DatabaseInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 99,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "        \"StorageEncrypted\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"StorageEncrypted\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "DatabaseInstance",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 91,
                  "EndLine": 107
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "Public access block does not block public ACLs",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3BucketWithLogging",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 20,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          \"BlockPublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3BucketWithLogging",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "Public access block does not block public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3BucketWithLogging",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 21,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          \"BlockPublicPolicy\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicPolicy\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3BucketWithLogging",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      \"Type\": \"AWS::S3::Bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        \"BucketName\": \"trivy-test-logging-bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"BucketName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-logging-bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        \"AccessControl\": \"PublicRead\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AccessControl\"\u001b[0m: \u001b[38;5;37m\"PublicRead\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        \"PublicAccessBlockConfiguration\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"PublicAccessBlockConfiguration\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          \"BlockPublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          \"BlockPublicPolicy\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicPolicy\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          \"IgnorePublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IgnorePublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      \"Type\": \"AWS::S3::Bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        \"BucketName\": \"trivy-test-logging-bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"BucketName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-logging-bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        \"AccessControl\": \"PublicRead\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AccessControl\"\u001b[0m: \u001b[38;5;37m\"PublicRead\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        \"PublicAccessBlockConfiguration\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"PublicAccessBlockConfiguration\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          \"BlockPublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          \"BlockPublicPolicy\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicPolicy\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          \"IgnorePublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IgnorePublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      \"Type\": \"AWS::S3::Bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        \"BucketName\": \"trivy-test-logging-bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"BucketName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-logging-bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        \"AccessControl\": \"PublicRead\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AccessControl\"\u001b[0m: \u001b[38;5;37m\"PublicRead\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        \"PublicAccessBlockConfiguration\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"PublicAccessBlockConfiguration\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          \"BlockPublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          \"BlockPublicPolicy\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicPolicy\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          \"IgnorePublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IgnorePublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "Public access block does not ignore public ACLs",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3BucketWithLogging",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 22,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          \"IgnorePublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IgnorePublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3BucketWithLogging",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0092",
          "AVDID": "AVD-AWS-0092",
          "Title": "S3 Buckets not publicly accessible through ACL.",
          "Description": "Buckets should not have ACLs that allow public access\n",
          "Message": "Bucket has a public ACL: \"public-read\"",
          "Namespace": "builtin.aws.s3.aws0092",
          "Query": "data.builtin.aws.s3.aws0092.deny",
          "Resolution": "Don't use canned ACLs or switch to private acl",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0092",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0092"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3BucketWithLogging",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        \"AccessControl\": \"PublicRead\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AccessControl\"\u001b[0m: \u001b[38;5;37m\"PublicRead\"\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3BucketWithLogging",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "Public access block does not restrict public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3BucketWithLogging",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 23,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          \"RestrictPublicBuckets\": false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"RestrictPublicBuckets\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3BucketWithLogging",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 14,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 67,
            "EndLine": 67,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 85,
            "EndLine": 85,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "DatabaseSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 113,
            "EndLine": 118,
            "Code": {
              "Lines": [
                {
                  "Number": 109,
                  "Content": "    \"DatabaseSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "      \"Type\": \"AWS::EC2::SecurityGroup\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::SecurityGroup\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "      \"Properties\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "        \"GroupDescription\": \"Security group for database\",",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"GroupDescription\"\u001b[0m: \u001b[38;5;37m\"Security group for database\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "        \"SecurityGroupIngress\": [{",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"SecurityGroupIngress\"\u001b[0m: [{",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "          \"IpProtocol\": \"tcp\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IpProtocol\"\u001b[0m: \u001b[38;5;37m\"tcp\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "          \"FromPort\": 5432,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"FromPort\"\u001b[0m: \u001b[38;5;37m5432\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "          \"ToPort\": 5432,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"ToPort\"\u001b[0m: \u001b[38;5;37m5432\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "          \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 118,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "DatabaseSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 109,
                  "EndLine": 120
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 69,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "          {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "            \"IpProtocol\": \"tcp\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"IpProtocol\"\u001b[0m: \u001b[38;5;37m\"tcp\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "            \"FromPort\": 80,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"FromPort\"\u001b[0m: \u001b[38;5;37m80\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "            \"ToPort\": 80,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"ToPort\"\u001b[0m: \u001b[38;5;37m80\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "          },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          },",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 75,
            "EndLine": 80,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "          {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "            \"IpProtocol\": \"tcp\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"IpProtocol\"\u001b[0m: \u001b[38;5;37m\"tcp\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "            \"FromPort\": 443,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"FromPort\"\u001b[0m: \u001b[38;5;37m443\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "            \"ToPort\": 443,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"ToPort\"\u001b[0m: \u001b[38;5;37m443\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "          },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          },",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 63,
            "EndLine": 68,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "          {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "            \"IpProtocol\": \"tcp\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"IpProtocol\"\u001b[0m: \u001b[38;5;37m\"tcp\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "            \"FromPort\": 22,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"FromPort\"\u001b[0m: \u001b[38;5;37m22\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "            \"ToPort\": 22,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"ToPort\"\u001b[0m: \u001b[38;5;37m22\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "          },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          },",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 81,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "    \"WebServerSecurityGroup\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerSecurityGroup\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "          {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "            \"IpProtocol\": \"tcp\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"IpProtocol\"\u001b[0m: \u001b[38;5;37m\"tcp\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "            \"FromPort\": 3389,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"FromPort\"\u001b[0m: \u001b[38;5;37m3389\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "            \"ToPort\": 3389,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"ToPort\"\u001b[0m: \u001b[38;5;37m3389\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            \"CidrIp\": \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"CidrIp\"\u001b[0m: \u001b[38;5;37m\"0.0.0.0/0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "          }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 88,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerSecurityGroup",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 89
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "WebServerInstance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 52,
            "EndLine": 52,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "    \"WebServerInstance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"WebServerInstance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "            \"Encrypted\": false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Encrypted\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 55,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "WebServerInstance",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 28,
                  "EndLine": 56
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:14-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    \"S3BucketWithLogging\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      \"Type\": \"AWS::S3::Bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::S3::Bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        \"BucketName\": \"trivy-test-logging-bucket\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"BucketName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-logging-bucket\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        \"AccessControl\": \"PublicRead\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AccessControl\"\u001b[0m: \u001b[38;5;37m\"PublicRead\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        \"PublicAccessBlockConfiguration\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"PublicAccessBlockConfiguration\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "          \"BlockPublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "          \"BlockPublicPolicy\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"BlockPublicPolicy\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "          \"IgnorePublicAcls\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33m\"IgnorePublicAcls\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0133",
          "AVDID": "AVD-AWS-0133",
          "Title": "Enable Performance Insights to detect potential problems",
          "Description": "Enabling Performance insights allows for greater depth in monitoring data.\nFor example, information about active sessions could help diagose a compromise or assist in the investigation\n",
          "Message": "Instance does not have performance insights enabled.",
          "Namespace": "builtin.aws.rds.aws0133",
          "Query": "data.builtin.aws.rds.aws0133.deny",
          "Resolution": "Enable performance insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0133",
          "References": [
            "https://aws.amazon.com/rds/performance-insights/",
            "https://avd.aquasec.com/misconfig/avd-aws-0133"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:91-107",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 91,
            "EndLine": 107,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "      \"Type\": \"AWS::RDS::DBInstance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::RDS::DBInstance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        \"DBInstanceIdentifier\": \"trivy-test-database\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceIdentifier\"\u001b[0m: \u001b[38;5;37m\"trivy-test-database\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        \"DBInstanceClass\": \"db.t3.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceClass\"\u001b[0m: \u001b[38;5;37m\"db.t3.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        \"Engine\": \"postgres\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"Engine\"\u001b[0m: \u001b[38;5;37m\"postgres\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        \"EngineVersion\": \"13.7\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EngineVersion\"\u001b[0m: \u001b[38;5;37m\"13.7\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "        \"AllocatedStorage\": 20,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AllocatedStorage\"\u001b[0m: \u001b[38;5;37m20\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "        \"StorageEncrypted\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"StorageEncrypted\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0162",
          "AVDID": "AVD-AWS-0162",
          "Title": "CloudTrail logs should be stored in S3 and also sent to CloudWatch Logs",
          "Description": "Realtime log analysis is not available without enabling CloudWatch logging.\n\nCloudTrail is a web service that records AWS API calls made in a given account. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service.\n\nCloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs in a specified Amazon S3 bucket for long-term analysis, you can perform real-time analysis by configuring CloudTrail to send logs to CloudWatch Logs.\n\nFor a trail that is enabled in all Regions in an account, CloudTrail sends log files from all those Regions to a CloudWatch Logs log group.\n",
          "Message": "Trail does not have CloudWatch logging configured",
          "Namespace": "builtin.aws.cloudtrail.aws0162",
          "Query": "data.builtin.aws.cloudtrail.aws0162.deny",
          "Resolution": "Enable logging to CloudWatch",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0162",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html#send-cloudtrail-events-to-cloudwatch-logs-console",
            "https://avd.aquasec.com/misconfig/avd-aws-0162"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:122-131",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 122,
            "EndLine": 131,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "    \"CloudTrail\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"CloudTrail\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      \"Type\": \"AWS::CloudTrail::Trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "        \"TrailName\": \"trivy-test-trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"TrailName\"\u001b[0m: \u001b[38;5;37m\"trivy-test-trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "        \"S3BucketName\": {\"Ref\": \"S3BucketWithLogging\"},",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"S3BucketName\"\u001b[0m: {\u001b[38;5;33m\"Ref\"\u001b[0m: \u001b[38;5;37m\"S3BucketWithLogging\"\u001b[0m},",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "        \"IncludeGlobalServiceEvents\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IncludeGlobalServiceEvents\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "        \"IsMultiRegionTrail\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"IsMultiRegionTrail\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "        \"EnableLogFileValidation\": false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EnableLogFileValidation\"\u001b[0m: \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "      }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    }",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0176",
          "AVDID": "AVD-AWS-0176",
          "Title": "RDS IAM Database Authentication Disabled",
          "Description": "Ensure IAM Database Authentication is enabled for RDS database instances to manage database access",
          "Message": "Instance does not have IAM Authentication enabled",
          "Namespace": "builtin.aws.rds.aws0176",
          "Query": "data.builtin.aws.rds.aws0176.deny",
          "Resolution": "Modify the PostgreSQL and MySQL type RDS instances to enable IAM database authentication.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0176",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/iam-auth.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0176"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:91-107",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 91,
            "EndLine": 107,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "      \"Type\": \"AWS::RDS::DBInstance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::RDS::DBInstance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        \"DBInstanceIdentifier\": \"trivy-test-database\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceIdentifier\"\u001b[0m: \u001b[38;5;37m\"trivy-test-database\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        \"DBInstanceClass\": \"db.t3.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceClass\"\u001b[0m: \u001b[38;5;37m\"db.t3.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        \"Engine\": \"postgres\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"Engine\"\u001b[0m: \u001b[38;5;37m\"postgres\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        \"EngineVersion\": \"13.7\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EngineVersion\"\u001b[0m: \u001b[38;5;37m\"13.7\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "        \"AllocatedStorage\": 20,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AllocatedStorage\"\u001b[0m: \u001b[38;5;37m20\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "        \"StorageEncrypted\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"StorageEncrypted\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0177",
          "AVDID": "AVD-AWS-0177",
          "Title": "RDS Deletion Protection Disabled",
          "Description": "Ensure deletion protection is enabled for RDS database instances.",
          "Message": "Instance does not have Deletion Protection enabled",
          "Namespace": "builtin.aws.rds.aws0177",
          "Query": "data.builtin.aws.rds.aws0177.deny",
          "Resolution": "Modify the RDS instances to enable deletion protection.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0177",
          "References": [
            "https://aws.amazon.com/about-aws/whats-new/2018/09/amazon-rds-now-provides-database-deletion-protection/",
            "https://avd.aquasec.com/misconfig/avd-aws-0177"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.json:91-107",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 91,
            "EndLine": 107,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "      \"Type\": \"AWS::RDS::DBInstance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::RDS::DBInstance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "      \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "        \"DBInstanceIdentifier\": \"trivy-test-database\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceIdentifier\"\u001b[0m: \u001b[38;5;37m\"trivy-test-database\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "        \"DBInstanceClass\": \"db.t3.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"DBInstanceClass\"\u001b[0m: \u001b[38;5;37m\"db.t3.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "        \"Engine\": \"postgres\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"Engine\"\u001b[0m: \u001b[38;5;37m\"postgres\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        \"EngineVersion\": \"13.7\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"EngineVersion\"\u001b[0m: \u001b[38;5;37m\"13.7\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "        \"AllocatedStorage\": 20,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"AllocatedStorage\"\u001b[0m: \u001b[38;5;37m20\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "        \"StorageEncrypted\": false,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"StorageEncrypted\"\u001b[0m: \u001b[38;5;166mfalse\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0180",
          "AVDID": "AVD-AWS-0180",
          "Title": "RDS Publicly Accessible",
          "Description": "Ensures RDS instances and RDS Cluster instances are not launched into the public cloud.",
          "Message": "Instance has Public Access enabled",
          "Namespace": "builtin.aws.rds.aws0180",
          "Query": "data.builtin.aws.rds.aws0180.deny",
          "Resolution": "Remove the public endpoint from the RDS instance.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0180",
          "References": [
            "http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0180"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "DatabaseInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 104,
            "EndLine": 104,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "    \"DatabaseInstance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;37m\"DatabaseInstance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "        \"PubliclyAccessible\": true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33m\"PubliclyAccessible\"\u001b[0m: \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "    },",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    },",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "DatabaseInstance",
                "Filename": "cloudformation/template.json",
                "Location": {
                  "StartLine": 91,
                  "EndLine": 107
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "cloudformation/template.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 26
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.\n",
          "Message": "Log group is not encrypted.",
          "Namespace": "builtin.aws.cloudwatch.aws0017",
          "Query": "data.builtin.aws.cloudwatch.aws0017.deny",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:100-104",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 100,
            "EndLine": 104,
            "Code": {
              "Lines": [
                {
                  "Number": 100,
                  "Content": "  LogGroup:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mLogGroup\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "    Type: AWS::Logs::LogGroup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::Logs::LogGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "      LogGroupName: !Sub '/aws/lambda/trivy-test-${Environment}'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mLogGroupName\u001b[0m: !Sub '/aws/lambda/trivy-test-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "      RetentionInDays: 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mRetentionInDays\u001b[0m: \u001b[38;5;37m7\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:62-78",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 62,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "  EC2Instance:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mEC2Instance\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "    Type: AWS::EC2::Instance",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Instance",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "      ImageId: ami-0c94855ba95b798c7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mImageId\u001b[0m: ami-0c94855ba95b798c7",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "      InstanceType: t2.micro",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mInstanceType\u001b[0m: t2.micro",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "      SecurityGroupIds:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIds\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "      BlockDeviceMappings:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBlockDeviceMappings\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "        - DeviceName: /dev/xvda",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mDeviceName\u001b[0m: /dev/xvda",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 71,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:108-118",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 108,
            "EndLine": 118,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "  ApplicationLoadBalancer:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mApplicationLoadBalancer\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "    Type: AWS::ElasticLoadBalancingV2::LoadBalancer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::ElasticLoadBalancingV2::LoadBalancer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "      Name: trivy-test-alb",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mName\u001b[0m: trivy-test-alb",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "      Type: application",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mType\u001b[0m: application",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "      Scheme: internet-facing",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mScheme\u001b[0m: internet-facing",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "      SecurityGroups:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroups\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      Subnets:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnets\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 117,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "ApplicationLoadBalancer",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 113,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 108,
                  "Content": "  ApplicationLoadBalancer:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mApplicationLoadBalancer\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "    Type: AWS::ElasticLoadBalancingV2::LoadBalancer",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::ElasticLoadBalancingV2::LoadBalancer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 111,
                  "Content": "      Name: trivy-test-alb",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mName\u001b[0m: trivy-test-alb",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "      Type: application",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mType\u001b[0m: application",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "      Scheme: internet-facing",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mScheme\u001b[0m: internet-facing",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "      SecurityGroups:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroups\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      Subnets:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSubnets\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ApplicationLoadBalancer",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 108,
                  "EndLine": 118
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0066",
          "AVDID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.\n",
          "Message": "Function does not have tracing enabled.",
          "Namespace": "builtin.aws.lambda.aws0066",
          "Query": "data.builtin.aws.lambda.aws0066.deny",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:161-175",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 161,
            "EndLine": 175,
            "Code": {
              "Lines": [
                {
                  "Number": 161,
                  "Content": "  LambdaFunction:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mLambdaFunction\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 162,
                  "Content": "    Type: AWS::Lambda::Function",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::Lambda::Function",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 163,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 164,
                  "Content": "      FunctionName: trivy-test-function",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mFunctionName\u001b[0m: trivy-test-function",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 165,
                  "Content": "      Runtime: python3.9",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mRuntime\u001b[0m: python3.9",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 166,
                  "Content": "      Handler: index.lambda_handler",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mHandler\u001b[0m: index.lambda_handler",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 167,
                  "Content": "      Code:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCode\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 168,
                  "Content": "        ZipFile: |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mZipFile\u001b[0m: |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "          def lambda_handler(event, context):",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          def lambda_handler(event, context):",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 170,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0077",
          "AVDID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.\n",
          "Message": "Instance has very low backup retention period.",
          "Namespace": "builtin.aws.rds.aws0077",
          "Query": "data.builtin.aws.rds.aws0077.deny",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "RDSInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 93,
            "EndLine": 93,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "      BackupRetentionPeriod: 0  # No backups - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mBackupRetentionPeriod\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# No backups - security issue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "RDSInstance",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 81,
                  "EndLine": 97
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0080",
          "AVDID": "AVD-AWS-0080",
          "Title": "RDS encryption has not been enabled at a DB Instance level.",
          "Description": "Encryption should be enabled for an RDS Database instances.\nWhen enabling encryption by setting the kms_key_id.\n",
          "Message": "Instance does not have storage encryption enabled.",
          "Namespace": "builtin.aws.rds.aws0080",
          "Query": "data.builtin.aws.rds.aws0080.deny",
          "Resolution": "Enable encryption for RDS instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0080",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0080"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "RDSInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 89,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      StorageEncrypted: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mStorageEncrypted\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "RDSInstance",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 81,
                  "EndLine": 97
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "Public access block does not block public ACLs",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 23,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3Bucket",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "Public access block does not block public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 24,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3Bucket",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:18-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:18-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:18-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "Public access block does not ignore public ACLs",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 25,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3Bucket",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "Public access block does not restrict public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 26,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "S3Bucket",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 26
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 59,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "          CidrIp: 0.0.0.0/0  # Too permissive",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0  \u001b[38;5;239m# Too permissive\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 59
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 55,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "          CidrIp: 0.0.0.0/0  # Too permissive",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0  \u001b[38;5;239m# Too permissive",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "          CidrIp: 0.0.0.0/0  # Too permissive",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0  \u001b[38;5;239m# Too permissive\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 59
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 56,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "      GroupDescription: Allow all traffic",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mGroupDescription\u001b[0m: Allow all traffic",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      SecurityGroupIngress:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIngress\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        - IpProtocol: tcp",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mIpProtocol\u001b[0m: tcp",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "          FromPort: 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mFromPort\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "          ToPort: 65535",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mToPort\u001b[0m: \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "          CidrIp: 0.0.0.0/0  # Too permissive",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0  \u001b[38;5;239m# Too permissive",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 59
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "SecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 52,
            "EndLine": 55,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  SecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "    Type: AWS::EC2::SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "      GroupDescription: Allow all traffic",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mGroupDescription\u001b[0m: Allow all traffic",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      SecurityGroupIngress:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mSecurityGroupIngress\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        - IpProtocol: tcp",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mIpProtocol\u001b[0m: tcp",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "          FromPort: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mFromPort\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "          ToPort: 65535",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mToPort\u001b[0m: \u001b[38;5;37m65535",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "          CidrIp: 0.0.0.0/0  # Too permissive",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0  \u001b[38;5;239m# Too permissive",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 56,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "SecurityGroup",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 47,
                  "EndLine": 59
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 74,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "  EC2Instance:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mEC2Instance\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "            Encrypted: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mEncrypted\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 77,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "        HttpTokens: optional  # Should be required",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mHttpTokens\u001b[0m: optional  \u001b[38;5;239m# Should be required\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 62,
                  "EndLine": 78
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:18-26",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "  S3Bucket:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mS3Bucket\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    Type: AWS::S3::Bucket",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::S3::Bucket",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      BucketName: !Sub 'trivy-test-bucket-${Environment}'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mBucketName\u001b[0m: !Sub 'trivy-test-bucket-${Environment}'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "      PublicAccessBlockConfiguration:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mPublicAccessBlockConfiguration\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        BlockPublicAcls: false       # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mBlockPublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m       \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        BlockPublicPolicy: false     # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mBlockPublicPolicy\u001b[0m: \u001b[38;5;166mfalse\u001b[0m     \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "        IgnorePublicAcls: false      # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mIgnorePublicAcls\u001b[0m: \u001b[38;5;166mfalse\u001b[0m      \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "        RestrictPublicBuckets: false # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mRestrictPublicBuckets\u001b[0m: \u001b[38;5;166mfalse\u001b[0m \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0133",
          "AVDID": "AVD-AWS-0133",
          "Title": "Enable Performance Insights to detect potential problems",
          "Description": "Enabling Performance insights allows for greater depth in monitoring data.\nFor example, information about active sessions could help diagose a compromise or assist in the investigation\n",
          "Message": "Instance does not have performance insights enabled.",
          "Namespace": "builtin.aws.rds.aws0133",
          "Query": "data.builtin.aws.rds.aws0133.deny",
          "Resolution": "Enable performance insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0133",
          "References": [
            "https://aws.amazon.com/rds/performance-insights/",
            "https://avd.aquasec.com/misconfig/avd-aws-0133"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:81-97",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 81,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "    Type: AWS::RDS::DBInstance",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::RDS::DBInstance",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "      DBInstanceIdentifier: trivy-test-db",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mDBInstanceIdentifier\u001b[0m: trivy-test-db",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "      DBInstanceClass: db.t3.micro",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mDBInstanceClass\u001b[0m: db.t3.micro",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      Engine: mysql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEngine\u001b[0m: mysql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      EngineVersion: '8.0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEngineVersion\u001b[0m: \u001b[38;5;37m'8.0'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      AllocatedStorage: 20",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mAllocatedStorage\u001b[0m: \u001b[38;5;37m20",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      StorageEncrypted: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mStorageEncrypted\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "PublicSubnet1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 141,
            "EndLine": 141,
            "Code": {
              "Lines": [
                {
                  "Number": 135,
                  "Content": "  PublicSubnet1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "      CidrBlock: 10.0.1.0/24",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.1.0\u001b[0m/24",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "      AvailabilityZone: !Select [0, !GetAZs '']",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [0, !GetAZs '']",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet1",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 135,
                  "EndLine": 141
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "PublicSubnet2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 149,
            "EndLine": 149,
            "Code": {
              "Lines": [
                {
                  "Number": 143,
                  "Content": "  PublicSubnet2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "      CidrBlock: 10.0.2.0/24",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: \u001b[38;5;37m10.0.2.0\u001b[0m/24",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      AvailabilityZone: !Select [1, !GetAZs '']",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [1, !GetAZs '']",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet2",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 143,
                  "EndLine": 149
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0176",
          "AVDID": "AVD-AWS-0176",
          "Title": "RDS IAM Database Authentication Disabled",
          "Description": "Ensure IAM Database Authentication is enabled for RDS database instances to manage database access",
          "Message": "Instance does not have IAM Authentication enabled",
          "Namespace": "builtin.aws.rds.aws0176",
          "Query": "data.builtin.aws.rds.aws0176.deny",
          "Resolution": "Modify the PostgreSQL and MySQL type RDS instances to enable IAM database authentication.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0176",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/iam-auth.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0176"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "cloudformation/template.yaml:81-97",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 81,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "    Type: AWS::RDS::DBInstance",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::RDS::DBInstance",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    Properties:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "      DBInstanceIdentifier: trivy-test-db",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mDBInstanceIdentifier\u001b[0m: trivy-test-db",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "      DBInstanceClass: db.t3.micro",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mDBInstanceClass\u001b[0m: db.t3.micro",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      Engine: mysql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEngine\u001b[0m: mysql",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      EngineVersion: '8.0'",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mEngineVersion\u001b[0m: \u001b[38;5;37m'8.0'",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      AllocatedStorage: 20",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mAllocatedStorage\u001b[0m: \u001b[38;5;37m20",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      StorageEncrypted: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mStorageEncrypted\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0177",
          "AVDID": "AVD-AWS-0177",
          "Title": "RDS Deletion Protection Disabled",
          "Description": "Ensure deletion protection is enabled for RDS database instances.",
          "Message": "Instance does not have Deletion Protection enabled",
          "Namespace": "builtin.aws.rds.aws0177",
          "Query": "data.builtin.aws.rds.aws0177.deny",
          "Resolution": "Modify the RDS instances to enable deletion protection.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0177",
          "References": [
            "https://aws.amazon.com/about-aws/whats-new/2018/09/amazon-rds-now-provides-database-deletion-protection/",
            "https://avd.aquasec.com/misconfig/avd-aws-0177"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "RDSInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 95,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "      DeletionProtection: false  # Should be true for production",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mDeletionProtection\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true for production",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "RDSInstance",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 81,
                  "EndLine": 97
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0180",
          "AVDID": "AVD-AWS-0180",
          "Title": "RDS Publicly Accessible",
          "Description": "Ensures RDS instances and RDS Cluster instances are not launched into the public cloud.",
          "Message": "Instance has Public Access enabled",
          "Namespace": "builtin.aws.rds.aws0180",
          "Query": "data.builtin.aws.rds.aws0180.deny",
          "Resolution": "Remove the public endpoint from the RDS instance.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0180",
          "References": [
            "http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0180"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "RDSInstance",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 94,
            "EndLine": 94,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  RDSInstance:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mRDSInstance\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "      PubliclyAccessible: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mPubliclyAccessible\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 96,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "        - !Ref SecurityGroup",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - !Ref SecurityGroup",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "RDSInstance",
                "Filename": "cloudformation/template.yaml",
                "Location": {
                  "StartLine": 81,
                  "EndLine": 97
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "docker/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 22,
        "Failures": 9
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS001",
          "AVDID": "AVD-DS-0001",
          "Title": "':latest' tag used",
          "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
          "Message": "Specify a tag in the 'FROM' statement for image 'ubuntu'",
          "Namespace": "builtin.dockerfile.DS001",
          "Query": "data.builtin.dockerfile.DS001.deny",
          "Resolution": "Add a tag to the image in the 'FROM' statement",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds001",
          "References": [
            "https://avd.aquasec.com/misconfig/ds001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 4,
            "EndLine": 4,
            "Code": {
              "Lines": [
                {
                  "Number": 4,
                  "Content": "FROM ubuntu:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mFROM\u001b[0m\u001b[38;5;37m ubuntu:latest\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Last USER command in Dockerfile should not be 'root'",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 7,
            "EndLine": 7,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "USER root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mUSER\u001b[0m\u001b[38;5;37m root\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS004",
          "AVDID": "AVD-DS-0004",
          "Title": "Port 22 exposed",
          "Description": "Exposing port 22 might allow users to SSH into the container.",
          "Message": "Port 22 should not be exposed in Dockerfile",
          "Namespace": "builtin.dockerfile.DS004",
          "Query": "data.builtin.dockerfile.DS004.deny",
          "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds004",
          "References": [
            "https://avd.aquasec.com/misconfig/ds004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 45,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 45,
                  "Content": "EXPOSE 22    # SSH",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mEXPOSE\u001b[0m\u001b[38;5;37m 22    # SSH\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS014",
          "AVDID": "AVD-DS-0014",
          "Title": "RUN using 'wget' and 'curl'",
          "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
          "Message": "Shouldn't use both curl and wget",
          "Namespace": "builtin.dockerfile.DS014",
          "Query": "data.builtin.dockerfile.DS014.deny",
          "Resolution": "Pick one util, either 'wget' or 'curl'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds014",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
            "https://avd.aquasec.com/misconfig/ds014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 42,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "RUN wget -O - https://some-untrusted-site.com/install.sh | bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m wget -O - https://some-untrusted-site.com/install.sh | bash",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS029",
          "AVDID": "AVD-DS-0029",
          "Title": "'apt-get' missing '--no-install-recommends'",
          "Description": "'apt-get' install should use '--no-install-recommends' to minimize image size.",
          "Message": "'--no-install-recommends' flag is missed: 'apt-get install -y     gcc     make     build-essential     gdb     strace'",
          "Namespace": "builtin.dockerfile.DS029",
          "Query": "data.builtin.dockerfile.DS029.deny",
          "Resolution": "Add '--no-install-recommends' flag to 'apt-get'",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds029",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 59,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 59,
                  "Content": "RUN apt-get install -y \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mRUN\u001b[0m apt-get install -y \u001b[38;5;124m\\",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "    gcc \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    gcc \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "    make \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    make \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "    build-essential \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    build-essential \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "    gdb \\",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    gdb \u001b[38;5;124m\\",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "    strace",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    strace",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"ADMIN_PASSWORD\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 25,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "ENV ADMIN_PASSWORD=admin123",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mENV\u001b[0m \u001b[38;5;33mADMIN_PASSWORD\u001b[0m\u001b[38;5;245m=\u001b[0madmin123",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"API_KEY\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 23,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "ENV API_KEY=sk-1234567890abcdef",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mENV\u001b[0m \u001b[38;5;33mAPI_KEY\u001b[0m\u001b[38;5;245m=\u001b[0msk-1234567890abcdef",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"DATABASE_PASSWORD\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 22,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "ENV DATABASE_PASSWORD=password123",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mENV\u001b[0m \u001b[38;5;33mDATABASE_PASSWORD\u001b[0m\u001b[38;5;245m=\u001b[0mpassword123",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"SECRET_TOKEN\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 24,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "ENV SECRET_TOKEN=abc123xyz789",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;64mENV\u001b[0m \u001b[38;5;33mSECRET_TOKEN\u001b[0m\u001b[38;5;245m=\u001b[0mabc123xyz789",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "docker/Dockerfile.webapp",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 23,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "AVDID": "AVD-DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS004",
          "AVDID": "AVD-DS-0004",
          "Title": "Port 22 exposed",
          "Description": "Exposing port 22 might allow users to SSH into the container.",
          "Message": "Port 22 should not be exposed in Dockerfile",
          "Namespace": "builtin.dockerfile.DS004",
          "Query": "data.builtin.dockerfile.DS004.deny",
          "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds004",
          "References": [
            "https://avd.aquasec.com/misconfig/ds004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 74,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 74,
                  "Content": "EXPOSE 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "EXPOSE 22",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS011",
          "AVDID": "AVD-DS-0011",
          "Title": "COPY with more than two arguments not ending with slash",
          "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
          "Message": "Slash is expected at the end of COPY command argument 'secrets'",
          "Namespace": "builtin.dockerfile.DS011",
          "Query": "data.builtin.dockerfile.DS011.deny",
          "Resolution": "Add slash to last COPY argument",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds011",
          "References": [
            "https://docs.docker.com/engine/reference/builder/#copy",
            "https://avd.aquasec.com/misconfig/ds011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 11,
            "EndLine": 11,
            "Code": {
              "Lines": [
                {
                  "Number": 11,
                  "Content": "COPY .env ./  # Copying environment file with secrets",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "COPY .env ./  # Copying environment file with secrets",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS026",
          "AVDID": "AVD-DS-0026",
          "Title": "No HEALTHCHECK defined",
          "Description": "You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.",
          "Message": "Add HEALTHCHECK instruction in your Dockerfile",
          "Namespace": "builtin.dockerfile.DS026",
          "Query": "data.builtin.dockerfile.DS026.deny",
          "Resolution": "Add HEALTHCHECK instruction in Dockerfile",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds026",
          "References": [
            "https://blog.aquasec.com/docker-security-best-practices",
            "https://avd.aquasec.com/misconfig/ds026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"ENCRYPTION_KEY\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 47,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "ENV ENCRYPTION_KEY=aes-256-key-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "ENV ENCRYPTION_KEY=aes-256-key-secret",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS031",
          "AVDID": "AVD-DS-0031",
          "Title": "Secrets passed via `build-args` or envs or copied secret files",
          "Description": "Passing secrets via `build-args` or envs or copying secret files can leak them out",
          "Message": "Possible exposure of secret env \"JWT_SECRET\" in ENV",
          "Namespace": "builtin.dockerfile.DS031",
          "Query": "data.builtin.dockerfile.DS031.deny",
          "Resolution": "Use secret mount if secrets are needed during image build. Use volume mount if secret files are needed during container runtime.",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds031",
          "References": [
            "https://docs.docker.com/build/building/secrets/",
            "https://avd.aquasec.com/misconfig/ds031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "StartLine": 46,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "ENV JWT_SECRET=super-secret-jwt-key-123",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "ENV JWT_SECRET=super-secret-jwt-key-123",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "kubernetes/deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 116,
        "Failures": 59
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'app' of 'deployment' 'vulnerable-app' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'privileged-container' of 'pod' 'privileged-pod' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV005",
          "AVDID": "AVD-KSV-0005",
          "Title": "SYS_ADMIN capability added",
          "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'",
          "Namespace": "builtin.kubernetes.KSV005",
          "Query": "data.builtin.kubernetes.KSV005.deny",
          "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv005",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
            "https://avd.aquasec.com/misconfig/ksv005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV006",
          "AVDID": "AVD-KSV-0006",
          "Title": "hostPath volume mounted with docker.sock",
          "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
          "Message": "Pod 'privileged-pod' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
          "Namespace": "builtin.kubernetes.KSV006",
          "Query": "data.builtin.kubernetes.KSV006.deny",
          "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv006",
          "References": [
            "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
            "https://avd.aquasec.com/misconfig/ksv006"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV008",
          "AVDID": "AVD-KSV-0008",
          "Title": "Access to host IPC namespace",
          "Description": "Sharing the hosts IPC namespace allows container processes to communicate with processes on the host.",
          "Message": "Pod 'privileged-pod' should not set 'spec.template.spec.hostIPC' to true",
          "Namespace": "builtin.kubernetes.KSV008",
          "Query": "data.builtin.kubernetes.KSV008.deny",
          "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv008",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv008"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV009",
          "AVDID": "AVD-KSV-0009",
          "Title": "Access to host network",
          "Description": "Sharing the hosts network namespace permits processes in the pod to communicate with processes bound to the hosts loopback adapter.",
          "Message": "Pod 'privileged-pod' should not set 'spec.template.spec.hostNetwork' to true",
          "Namespace": "builtin.kubernetes.KSV009",
          "Query": "data.builtin.kubernetes.KSV009.deny",
          "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv009",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv009"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV010",
          "AVDID": "AVD-KSV-0010",
          "Title": "Access to host PID",
          "Description": "Sharing the hosts PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
          "Message": "Pod 'privileged-pod' should not set 'spec.template.spec.hostPID' to true",
          "Namespace": "builtin.kubernetes.KSV010",
          "Query": "data.builtin.kubernetes.KSV010.deny",
          "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv010",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV017",
          "AVDID": "AVD-KSV-0017",
          "Title": "Privileged",
          "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.privileged' to false",
          "Namespace": "builtin.kubernetes.KSV017",
          "Query": "data.builtin.kubernetes.KSV017.deny",
          "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV017",
          "AVDID": "AVD-KSV-0017",
          "Title": "Privileged",
          "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.privileged' to false",
          "Namespace": "builtin.kubernetes.KSV017",
          "Query": "data.builtin.kubernetes.KSV017.deny",
          "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV022",
          "AVDID": "AVD-KSV-0022",
          "Title": "Specific capabilities added",
          "Description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should not set 'securityContext.capabilities.add'",
          "Namespace": "builtin.kubernetes.KSV022",
          "Query": "data.builtin.kubernetes.KSV022.deny",
          "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "Deployment 'vulnerable-app' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 7,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "  replicas: 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mreplicas\u001b[0m: \u001b[38;5;37m3",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "      app: vulnerable-app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: vulnerable-app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        app: vulnerable-app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: vulnerable-app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "Pod 'privileged-pod' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container app of deployment vulnerable-app in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container privileged-container of pod privileged-pod in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container app of deployment vulnerable-app in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container privileged-container of pod privileged-pod in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV034",
          "AVDID": "AVD-KSV-0034",
          "Title": "Container images from public registries used",
          "Description": "Container images must not start with an empty prefix or a defined public registry domain.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should restrict container image to use private registries",
          "Namespace": "builtin.kubernetes.KSV034",
          "Query": "data.builtin.kubernetes.KSV034.deny",
          "Resolution": "Use images from private registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv034",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'app' of Deployment 'vulnerable-app' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'privileged-container' of Pod 'privileged-pod' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV044",
          "AVDID": "AVD-KSV-0044",
          "Title": "No wildcard verb and resource roles",
          "Description": "Check whether role permits wildcard verb on wildcard resource",
          "Message": "Role permits wildcard verb on wildcard resource",
          "Namespace": "builtin.kubernetes.KSV044",
          "Query": "data.builtin.kubernetes.KSV044.deny",
          "Resolution": "Create a role which does not permit wildcard verb on wildcard resource",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv044",
          "References": [
            "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
            "https://avd.aquasec.com/misconfig/ksv044"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 144,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 144,
                  "Content": "- apiGroups: [\"*\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "  resources: [\"*\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mresources\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "  verbs: [\"*\"]  # Too permissive - allows everything",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]  \u001b[38;5;239m# Too permissive - allows everything\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV046",
          "AVDID": "AVD-KSV-0046",
          "Title": "Manage all resources",
          "Description": "Full control of the cluster resources, and therefore also root on all nodes where workloads can run and has access to all pods, secrets, and data.",
          "Message": "ClusterRole 'overprivileged-role' shouldn't manage all resources",
          "Namespace": "builtin.kubernetes.KSV046",
          "Query": "data.builtin.kubernetes.KSV046.deny",
          "Resolution": "Remove '*' from 'rules.resources'. Provide specific list of resources to be managed by cluster role",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv046",
          "References": [
            "https://kubernetes.io/docs/concepts/security/rbac-good-practices/",
            "https://avd.aquasec.com/misconfig/ksv046"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 144,
            "EndLine": 146,
            "Code": {
              "Lines": [
                {
                  "Number": 144,
                  "Content": "- apiGroups: [\"*\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "- \u001b[38;5;33mapiGroups\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "  resources: [\"*\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mresources\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "  verbs: [\"*\"]  # Too permissive - allows everything",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mverbs\u001b[0m: [\u001b[38;5;37m\"*\"\u001b[0m]  \u001b[38;5;239m# Too permissive - allows everything\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-01010",
          "AVDID": "AVD-KSV-01010",
          "Title": "ConfigMap with sensitive content",
          "Description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
          "Message": "ConfigMap 'app-config' in 'default' namespace stores sensitive contents in key(s) or value(s) '{\"secret_key\"}'",
          "Namespace": "builtin.kubernetes.KSV01010",
          "Query": "data.builtin.kubernetes.KSV01010.deny",
          "Resolution": "Remove sensitive content from configMap data value",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-01010",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-01010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 127,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 127,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"app\" of deployment \"vulnerable-app\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"privileged-container\" of pod \"privileged-pod\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 24,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          privileged: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "          readOnlyRootFilesystem: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mreadOnlyRootFilesystem\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "          runAsNonRoot: false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsNonRoot\u001b[0m: \u001b[38;5;166mfalse\u001b[0m  \u001b[38;5;239m# Should be true\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 86,
            "EndLine": 93,
            "Code": {
              "Lines": [
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "        - SYS_ADMIN  # Dangerous capability",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - SYS_ADMIN  \u001b[38;5;239m# Dangerous capability",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "        - NET_ADMIN",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        - NET_ADMIN",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "        - SYS_TIME",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - SYS_TIME",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 18,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          allowPrivilegeEscalation: true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Should be false",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 100,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "        add:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33madd\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "AVD-KSV-0109",
          "AVDID": "AVD-KSV-0109",
          "Title": "ConfigMap with secrets",
          "Description": "Storing secrets in configMaps is unsafe",
          "Message": "ConfigMap 'app-config' in 'default' namespace stores secrets in key(s) or value(s) '{\"database_password\", \"secret_key\"}'",
          "Namespace": "builtin.kubernetes.KSV0109",
          "Query": "data.builtin.kubernetes.KSV0109.deny",
          "Resolution": "Remove password/secret from configMap data value",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-ksv-0109",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-ksv-0109"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 127,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 127,
                  "Content": "---",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "---",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "deployment vulnerable-app in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 4,
            "EndLine": 5,
            "Code": {
              "Lines": [
                {
                  "Number": 4,
                  "Content": "  name: vulnerable-app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: vulnerable-app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  namespace: default",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mnamespace\u001b[0m: default",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "pod privileged-pod in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 79,
            "EndLine": 79,
            "Code": {
              "Lines": [
                {
                  "Number": 79,
                  "Content": "  name: privileged-pod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: privileged-pod",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV117",
          "AVDID": "AVD-KSV-0117",
          "Title": "Prevent binding to privileged ports",
          "Description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
          "Message": "deployment vulnerable-app in default namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024",
          "Namespace": "builtin.kubernetes.KSV117",
          "Query": "data.builtin.kubernetes.KSV117.deny",
          "Resolution": "Do not map the container ports to privileged host ports when starting a container.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv117",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/",
            "https://www.stigviewer.com/stig/kubernetes/2022-12-02/finding/V-242414",
            "https://avd.aquasec.com/misconfig/ksv117"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "Code": {
              "Lines": null
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment vulnerable-app in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 17,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "      - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        image: nginx:latest  # Using latest tag - not recommended",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: nginx:latest  \u001b[38;5;239m# Using latest tag - not recommended",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        # Running as root - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;239m# Running as root - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          runAsUser: 0  # Should not run as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Should not run as root",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          runAsGroup: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsGroup\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "pod privileged-pod in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV121",
          "AVDID": "AVD-KSV-0121",
          "Title": "Kubernetes resource with disallowed volumes mounted",
          "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
          "Message": "deployment vulnerable-app in default namespace shouldn't have volumes set to {\"/\"}",
          "Namespace": "builtin.kubernetes.KSV121",
          "Query": "data.builtin.kubernetes.KSV121.deny",
          "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv121"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 7,
            "EndLine": 54,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "  replicas: 3",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mreplicas\u001b[0m: \u001b[38;5;37m3",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "      app: vulnerable-app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: vulnerable-app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        app: vulnerable-app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: vulnerable-app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV121",
          "AVDID": "AVD-KSV-0121",
          "Title": "Kubernetes resource with disallowed volumes mounted",
          "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
          "Message": "pod privileged-pod in default namespace shouldn't have volumes set to {\"/proc\", \"/sys\"}",
          "Namespace": "builtin.kubernetes.KSV121",
          "Query": "data.builtin.kubernetes.KSV121.deny",
          "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv121"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 81,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  - name: privileged-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: privileged-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    image: ubuntu:20.04",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: ubuntu:20.04",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    command: [\"/bin/sleep\", \"3600\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"/bin/sleep\"\u001b[0m, \u001b[38;5;37m\"3600\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "      privileged: true  # Major security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# Major security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "      capabilities:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcapabilities\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "kubernetes/misconfigured.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 116,
        "Failures": 98
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV001",
          "AVDID": "AVD-KSV-0001",
          "Title": "Can elevate its own privileges",
          "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.allowPrivilegeEscalation' to false",
          "Namespace": "builtin.kubernetes.KSV001",
          "Query": "data.builtin.kubernetes.KSV001.deny",
          "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'database' of Pod 'database-pod' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV003",
          "AVDID": "AVD-KSV-0003",
          "Title": "Default capabilities: some containers do not drop all",
          "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
          "Message": "Container 'job-container' of Job 'privileged-job' should add 'ALL' to 'securityContext.capabilities.drop'",
          "Namespace": "builtin.kubernetes.KSV003",
          "Query": "data.builtin.kubernetes.KSV003.deny",
          "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'agent' of 'daemonset' 'monitoring-agent' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'backup' of 'cronjob' 'backup-cronjob' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'database' of 'pod' 'database-pod' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV004",
          "AVDID": "AVD-KSV-0004",
          "Title": "Default capabilities: some containers do not drop any",
          "Description": "Security best practices require containers to run with minimal required capabilities.",
          "Message": "Container 'job-container' of 'job' 'privileged-job' in 'default' namespace should set securityContext.capabilities.drop",
          "Namespace": "builtin.kubernetes.KSV004",
          "Query": "data.builtin.kubernetes.KSV004.deny",
          "Resolution": "Specify at least one unneeded capability in 'containers[].securityContext.capabilities.drop'",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv004",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
            "https://avd.aquasec.com/misconfig/ksv004"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV006",
          "AVDID": "AVD-KSV-0006",
          "Title": "hostPath volume mounted with docker.sock",
          "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
          "Message": "DaemonSet 'monitoring-agent' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
          "Namespace": "builtin.kubernetes.KSV006",
          "Query": "data.builtin.kubernetes.KSV006.deny",
          "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv006",
          "References": [
            "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
            "https://avd.aquasec.com/misconfig/ksv006"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 140,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "      app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "        app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 149,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV009",
          "AVDID": "AVD-KSV-0009",
          "Title": "Access to host network",
          "Description": "Sharing the hosts network namespace permits processes in the pod to communicate with processes bound to the hosts loopback adapter.",
          "Message": "DaemonSet 'monitoring-agent' should not set 'spec.template.spec.hostNetwork' to true",
          "Namespace": "builtin.kubernetes.KSV009",
          "Query": "data.builtin.kubernetes.KSV009.deny",
          "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv009",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv009"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 140,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "      app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "        app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 149,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV009",
          "AVDID": "AVD-KSV-0009",
          "Title": "Access to host network",
          "Description": "Sharing the hosts network namespace permits processes in the pod to communicate with processes bound to the hosts loopback adapter.",
          "Message": "Pod 'database-pod' should not set 'spec.template.spec.hostNetwork' to true",
          "Namespace": "builtin.kubernetes.KSV009",
          "Query": "data.builtin.kubernetes.KSV009.deny",
          "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv009",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv009"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 111,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 111,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV010",
          "AVDID": "AVD-KSV-0010",
          "Title": "Access to host PID",
          "Description": "Sharing the hosts PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
          "Message": "DaemonSet 'monitoring-agent' should not set 'spec.template.spec.hostPID' to true",
          "Namespace": "builtin.kubernetes.KSV010",
          "Query": "data.builtin.kubernetes.KSV010.deny",
          "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv010",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 140,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "      app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "        app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 149,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV011",
          "AVDID": "AVD-KSV-0011",
          "Title": "CPU not limited",
          "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'resources.limits.cpu'",
          "Namespace": "builtin.kubernetes.KSV011",
          "Query": "data.builtin.kubernetes.KSV011.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV012",
          "AVDID": "AVD-KSV-0012",
          "Title": "Runs as root user",
          "Description": "Force the running image to run as a non-root user to ensure least privileges.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.runAsNonRoot' to true",
          "Namespace": "builtin.kubernetes.KSV012",
          "Query": "data.builtin.kubernetes.KSV012.deny",
          "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv012"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV013",
          "AVDID": "AVD-KSV-0013",
          "Title": "Image tag \":latest\" used",
          "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
          "Message": "Container 'job-container' of Job 'privileged-job' should specify an image tag",
          "Namespace": "builtin.kubernetes.KSV013",
          "Query": "data.builtin.kubernetes.KSV013.deny",
          "Resolution": "Use a specific container image tag that is not 'latest'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013",
          "References": [
            "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
            "https://avd.aquasec.com/misconfig/ksv013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV014",
          "AVDID": "AVD-KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV015",
          "AVDID": "AVD-KSV-0015",
          "Title": "CPU requests not specified",
          "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'resources.requests.cpu'",
          "Namespace": "builtin.kubernetes.KSV015",
          "Query": "data.builtin.kubernetes.KSV015.deny",
          "Resolution": "Set 'containers[].resources.requests.cpu'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015",
          "References": [
            "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
            "https://avd.aquasec.com/misconfig/ksv015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV016",
          "AVDID": "AVD-KSV-0016",
          "Title": "Memory requests not specified",
          "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'resources.requests.memory'",
          "Namespace": "builtin.kubernetes.KSV016",
          "Query": "data.builtin.kubernetes.KSV016.deny",
          "Resolution": "Set 'containers[].resources.requests.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV017",
          "AVDID": "AVD-KSV-0017",
          "Title": "Privileged",
          "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.privileged' to false",
          "Namespace": "builtin.kubernetes.KSV017",
          "Query": "data.builtin.kubernetes.KSV017.deny",
          "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV017",
          "AVDID": "AVD-KSV-0017",
          "Title": "Privileged",
          "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.privileged' to false",
          "Namespace": "builtin.kubernetes.KSV017",
          "Query": "data.builtin.kubernetes.KSV017.deny",
          "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV018",
          "AVDID": "AVD-KSV-0018",
          "Title": "Memory not limited",
          "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'resources.limits.memory'",
          "Namespace": "builtin.kubernetes.KSV018",
          "Query": "data.builtin.kubernetes.KSV018.deny",
          "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018",
          "References": [
            "https://kubesec.io/basics/containers-resources-limits-memory/",
            "https://avd.aquasec.com/misconfig/ksv018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV020",
          "AVDID": "AVD-KSV-0020",
          "Title": "Runs with UID \u003c= 10000",
          "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.runAsUser' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV020",
          "Query": "data.builtin.kubernetes.KSV020.deny",
          "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'database' of Pod 'database-pod' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV021",
          "AVDID": "AVD-KSV-0021",
          "Title": "Runs with GID \u003c= 10000",
          "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the hosts user table.",
          "Message": "Container 'job-container' of Job 'privileged-job' should set 'securityContext.runAsGroup' \u003e 10000",
          "Namespace": "builtin.kubernetes.KSV021",
          "Query": "data.builtin.kubernetes.KSV021.deny",
          "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-runasuser/",
            "https://avd.aquasec.com/misconfig/ksv021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "CronJob 'backup-cronjob' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 77,
            "EndLine": 103,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "  schedule: \"0 2 * * *\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mschedule\u001b[0m: \u001b[38;5;37m\"0 2 * * *\"",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  jobTemplate:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;33mjobTemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "        spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "          restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "          containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "DaemonSet 'monitoring-agent' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 140,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "      app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "        app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 149,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "Job 'privileged-job' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 47,
            "EndLine": 68,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "      restartPolicy: Never",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: Never",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 56,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV023",
          "AVDID": "AVD-KSV-0023",
          "Title": "hostPath volumes mounted",
          "Description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
          "Message": "Pod 'database-pod' should not set 'spec.template.volumes.hostPath'",
          "Namespace": "builtin.kubernetes.KSV023",
          "Query": "data.builtin.kubernetes.KSV023.deny",
          "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 111,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 111,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV024",
          "AVDID": "AVD-KSV-0024",
          "Title": "Access to host ports",
          "Description": "According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.",
          "Message": "Container 'database' of Pod 'database-pod' should not set host ports, 'ports[*].hostPort'",
          "Namespace": "builtin.kubernetes.KSV024",
          "Query": "data.builtin.kubernetes.KSV024.deny",
          "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv024",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV030",
          "AVDID": "AVD-KSV-0030",
          "Title": "Runtime/Default Seccomp profile not set",
          "Description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
          "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'",
          "Namespace": "builtin.kubernetes.KSV030",
          "Query": "data.builtin.kubernetes.KSV030.deny",
          "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container agent of daemonset monitoring-agent in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container backup of cronjob backup-cronjob in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container database of pod database-pod in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV032",
          "AVDID": "AVD-KSV-0032",
          "Title": "All container images must start with the *.azurecr.io domain",
          "Description": "Containers should only use images from trusted registries.",
          "Message": "container job-container of job privileged-job in default namespace should restrict container image to your specific registry domain. For Azure any domain ending in 'azurecr.io'",
          "Namespace": "builtin.kubernetes.KSV032",
          "Query": "data.builtin.kubernetes.KSV032.deny",
          "Resolution": "Use images from trusted Azure registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv032",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container agent of daemonset monitoring-agent in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container backup of cronjob backup-cronjob in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container database of pod database-pod in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV033",
          "AVDID": "AVD-KSV-0033",
          "Title": "All container images must start with a GCR domain",
          "Description": "Containers should only use images from trusted GCR registries.",
          "Message": "container job-container of job privileged-job in default namespace should restrict container image to your specific registry domain. See the full GCR list here: https://cloud.google.com/container-registry/docs/overview#registries",
          "Namespace": "builtin.kubernetes.KSV033",
          "Query": "data.builtin.kubernetes.KSV033.deny",
          "Resolution": "Use images from trusted GCR registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv033",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV034",
          "AVDID": "AVD-KSV-0034",
          "Title": "Container images from public registries used",
          "Description": "Container images must not start with an empty prefix or a defined public registry domain.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should restrict container image to use private registries",
          "Namespace": "builtin.kubernetes.KSV034",
          "Query": "data.builtin.kubernetes.KSV034.deny",
          "Resolution": "Use images from private registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv034",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV034",
          "AVDID": "AVD-KSV-0034",
          "Title": "Container images from public registries used",
          "Description": "Container images must not start with an empty prefix or a defined public registry domain.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should restrict container image to use private registries",
          "Namespace": "builtin.kubernetes.KSV034",
          "Query": "data.builtin.kubernetes.KSV034.deny",
          "Resolution": "Use images from private registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv034",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV034",
          "AVDID": "AVD-KSV-0034",
          "Title": "Container images from public registries used",
          "Description": "Container images must not start with an empty prefix or a defined public registry domain.",
          "Message": "Container 'job-container' of Job 'privileged-job' should restrict container image to use private registries",
          "Namespace": "builtin.kubernetes.KSV034",
          "Query": "data.builtin.kubernetes.KSV034.deny",
          "Resolution": "Use images from private registries.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv034",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'agent' of DaemonSet 'monitoring-agent' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'backup' of CronJob 'backup-cronjob' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'database' of Pod 'database-pod' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV035",
          "AVDID": "AVD-KSV-0035",
          "Title": "All container images must start with an ECR domain",
          "Description": "Container images from non-ECR registries should be forbidden.",
          "Message": "Container 'job-container' of Job 'privileged-job' should restrict images to own ECR repository. See the full ECR list here: https://docs.aws.amazon.com/general/latest/gr/ecr.html",
          "Namespace": "builtin.kubernetes.KSV035",
          "Query": "data.builtin.kubernetes.KSV035.deny",
          "Resolution": "Container image should be used from Amazon container Registry",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv035",
          "References": [
            "https://avd.aquasec.com/misconfig/ksv035"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"agent\" of daemonset \"monitoring-agent\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"backup\" of cronjob \"backup-cronjob\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"database\" of pod \"database-pod\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV104",
          "AVDID": "AVD-KSV-0104",
          "Title": "Seccomp policies disabled",
          "Description": "A program inside the container can bypass Seccomp protection policies.",
          "Message": "container \"job-container\" of job \"privileged-job\" in \"default\" namespace should specify a seccomp profile",
          "Namespace": "builtin.kubernetes.KSV104",
          "Query": "data.builtin.kubernetes.KSV104.deny",
          "Resolution": "Specify seccomp either by annotation or by seccomp profile type having allowed values as per pod security standards",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv104",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 96,
            "EndLine": 96,
            "Code": {
              "Lines": [
                {
                  "Number": 96,
                  "Content": "              runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 123,
            "EndLine": 124,
            "Code": {
              "Lines": [
                {
                  "Number": 123,
                  "Content": "      runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "      allowPrivilegeEscalation: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mallowPrivilegeEscalation\u001b[0m: \u001b[38;5;166mtrue\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 152,
            "EndLine": 153,
            "Code": {
              "Lines": [
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV105",
          "AVDID": "AVD-KSV-0105",
          "Title": "Containers must not set runAsUser to 0",
          "Description": "Containers should be forbidden from running with a root UID.",
          "Message": "securityContext.runAsUser should be set to a value greater than 0",
          "Namespace": "builtin.kubernetes.KSV105",
          "Query": "data.builtin.kubernetes.KSV105.deny",
          "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv105"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 60,
            "EndLine": 61,
            "Code": {
              "Lines": [
                {
                  "Number": 60,
                  "Content": "          runAsUser: 0  # Running as root",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0\u001b[0m  \u001b[38;5;239m# Running as root",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "          privileged: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 84,
            "EndLine": 99,
            "Code": {
              "Lines": [
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              pg_dump -h db.example.com -U admin -d myapp \u003e /backup/backup.sql\u001b[0m              ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "            env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 93,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 51,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          cat /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cat /tmp/secrets.txt\u001b[0m          ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 60,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 112,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    - name: MYSQL_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    - \u001b[38;5;33mname\u001b[0m: MYSQL_PASSWORD",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 121,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV106",
          "AVDID": "AVD-KSV-0106",
          "Title": "Container capabilities must only include NET_BIND_SERVICE",
          "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.",
          "Message": "container should drop all",
          "Namespace": "builtin.kubernetes.KSV106",
          "Query": "data.builtin.kubernetes.KSV106.deny",
          "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv106"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 149,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "          readOnly: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadOnly\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 158,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "cronjob backup-cronjob in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 75,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 75,
                  "Content": "  name: backup-cronjob",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: backup-cronjob",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "daemonset monitoring-agent in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 138,
            "EndLine": 138,
            "Code": {
              "Lines": [
                {
                  "Number": 138,
                  "Content": "  name: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: monitoring-agent",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "job privileged-job in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 45,
            "EndLine": 45,
            "Code": {
              "Lines": [
                {
                  "Number": 45,
                  "Content": "  name: privileged-job",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: privileged-job",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV110",
          "AVDID": "AVD-KSV-0110",
          "Title": "Workloads in the default namespace",
          "Description": "Checks whether a workload is running in the default namespace.",
          "Message": "pod database-pod in default namespace should set metadata.namespace to a non-default namespace",
          "Namespace": "builtin.kubernetes.KSV110",
          "Query": "data.builtin.kubernetes.KSV110.deny",
          "Resolution": "Set 'metadata.namespace' to a non-default namespace.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv110",
          "References": [
            "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/",
            "https://avd.aquasec.com/misconfig/ksv110"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 109,
            "EndLine": 109,
            "Code": {
              "Lines": [
                {
                  "Number": 109,
                  "Content": "  name: database-pod",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mname\u001b[0m: database-pod",
                  "FirstCause": true,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "cronjob backup-cronjob in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 82,
            "EndLine": 103,
            "Code": {
              "Lines": [
                {
                  "Number": 82,
                  "Content": "          restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "          containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "          - name: backup",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          - \u001b[38;5;33mname\u001b[0m: backup",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "            image: postgres:13",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mimage\u001b[0m: postgres:13",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "            command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "            - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "            - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "            - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "              export PGPASSWORD=hardcoded_password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m              export PGPASSWORD=hardcoded_password",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "daemonset monitoring-agent in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 148,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "      - name: agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "        image: monitoring-agent:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: monitoring-agent:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "        securityContext:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33msecurityContext\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "          privileged: true  # DaemonSet running privileged - high risk",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mprivileged\u001b[0m: \u001b[38;5;166mtrue\u001b[0m  \u001b[38;5;239m# DaemonSet running privileged - high risk",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "          runAsUser: 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mrunAsUser\u001b[0m: \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "        volumeMounts:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mvolumeMounts\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "        - name: proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: proc",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "          mountPath: /host/proc",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mmountPath\u001b[0m: /host/proc",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 157,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "job privileged-job in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 49,
            "EndLine": 68,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "      restartPolicy: Never",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: Never",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "          echo \"Running privileged job\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Running privileged job\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          echo \"DATABASE_PASSWORD=secret123\" \u003e /tmp/secrets.txt",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV118",
          "AVDID": "AVD-KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "pod database-pod in default namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv118"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 111,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 111,
                  "Content": "  containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 112,
                  "Content": "  - name: database",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  - \u001b[38;5;33mname\u001b[0m: database",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 113,
                  "Content": "    image: mysql:8.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mimage\u001b[0m: mysql:8.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "    ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "    - containerPort: 3306",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m3306",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "      hostPort: 3306  # Exposing on host port - security issue",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mhostPort\u001b[0m: \u001b[38;5;37m3306\u001b[0m  \u001b[38;5;239m# Exposing on host port - security issue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "    env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    - name: MYSQL_ROOT_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    - \u001b[38;5;33mname\u001b[0m: MYSQL_ROOT_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "      value: \"root_password_123\"  # Hardcoded root password",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"root_password_123\"\u001b[0m  \u001b[38;5;239m# Hardcoded root password",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV121",
          "AVDID": "AVD-KSV-0121",
          "Title": "Kubernetes resource with disallowed volumes mounted",
          "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
          "Message": "daemonset monitoring-agent in default namespace shouldn't have volumes set to {\"/proc\", \"/sys\"}",
          "Namespace": "builtin.kubernetes.KSV121",
          "Query": "data.builtin.kubernetes.KSV121.deny",
          "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv121"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 140,
            "EndLine": 177,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "      app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "        app: monitoring-agent",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mapp\u001b[0m: monitoring-agent",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 149,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV121",
          "AVDID": "AVD-KSV-0121",
          "Title": "Kubernetes resource with disallowed volumes mounted",
          "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
          "Message": "job privileged-job in default namespace shouldn't have volumes set to {\"/\"}",
          "Namespace": "builtin.kubernetes.KSV121",
          "Query": "data.builtin.kubernetes.KSV121.deny",
          "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv121",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv121"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 47,
            "EndLine": 68,
            "Code": {
              "Lines": [
                {
                  "Number": 47,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "      restartPolicy: Never",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: Never",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "      - name: job-container",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: job-container",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "        image: alpine:latest  # Using latest tag",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest  \u001b[38;5;239m# Using latest tag",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        command: [\"sh\", \"-c\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mcommand\u001b[0m: [\u001b[38;5;37m\"sh\"\u001b[0m, \u001b[38;5;37m\"-c\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 56,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        }
      ]
    },
    {
      "Target": "terraform",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 57,
        "Failures": 0
      }
    },
    {
      "Target": "terraform/main.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 26
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0017",
          "AVDID": "AVD-AWS-0017",
          "Title": "CloudWatch log groups should be encrypted using CMK",
          "Description": "CloudWatch log groups are encrypted by default, however, to get the full benefit of controlling key rotation and other KMS aspects a KMS CMK should be used.\n",
          "Message": "Log group is not encrypted.",
          "Namespace": "builtin.aws.cloudwatch.aws0017",
          "Query": "data.builtin.aws.cloudwatch.aws0017.deny",
          "Resolution": "Enable CMK encryption of CloudWatch Log Groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0017",
          "References": [
            "https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/encrypt-log-data-kms.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_cloudwatch_log_group.example",
            "Provider": "AWS",
            "Service": "cloudwatch",
            "StartLine": 113,
            "EndLine": 119,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "resource \"aws_cloudwatch_log_group\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_cloudwatch_log_group\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "  name              = \"/aws/lambda/trivy-test\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m              = \u001b[38;5;37m\"/aws/lambda/trivy-test\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  retention_in_days = 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mretention_in_days\u001b[0m = \u001b[38;5;37m7\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  # No KMS encryption",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # No KMS encryption",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  # kms_key_id = aws_kms_key.example.arn  # Should be enabled",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # kms_key_id = aws_kms_key.example.arn  # Should be enabled",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.web",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 60,
            "EndLine": 60,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_instance\" \"web\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"web\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "    http_tokens   = \"optional\"  # Should be \"required\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mhttp_tokens\u001b[0m   = \u001b[38;5;37m\"optional\"\u001b[0m\u001b[38;5;239m  # Should be \"required\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 65,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "metadata_options",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 58,
                  "EndLine": 61
                }
              },
              {
                "Resource": "aws_instance.web",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 66
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0052",
          "AVDID": "AVD-AWS-0052",
          "Title": "Load balancers should drop invalid headers",
          "Description": "Passing unknown or invalid headers through to the target poses a potential risk of compromise.\nBy setting drop_invalid_header_fields to true, anything that does not conform to well known, defined headers will be removed by the load balancer.\n",
          "Message": "Application load balancer is not set to drop invalid headers.",
          "Namespace": "builtin.aws.elb.aws0052",
          "Query": "data.builtin.aws.elb.aws0052.deny",
          "Resolution": "Set drop_invalid_header_fields to true",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0052",
          "References": [
            "https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lb.example",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 122,
            "EndLine": 137,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "resource \"aws_lb\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "  name               = \"trivy-test-alb\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mname\u001b[0m               = \u001b[38;5;37m\"trivy-test-alb\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  internal           = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m           = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "  load_balancer_type = \"application\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mload_balancer_type\u001b[0m = \u001b[38;5;37m\"application\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "  security_groups    = [aws_security_group.allow_all.id]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245msecurity_groups\u001b[0m    = [aws_security_group.allow_all.id]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 127,
                  "Content": "  subnets            = [aws_subnet.public1.id, aws_subnet.public2.id]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245msubnets\u001b[0m            = [aws_subnet.public1.id, aws_subnet.public2.id]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 128,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 129,
                  "Content": "  enable_deletion_protection = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245menable_deletion_protection\u001b[0m = \u001b[38;5;166mfalse\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 131,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "AVDID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.\n",
          "Message": "Load balancer is exposed publicly.",
          "Namespace": "builtin.aws.elb.aws0053",
          "Query": "data.builtin.aws.elb.aws0053.deny",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lb.example",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 124,
            "EndLine": 124,
            "Code": {
              "Lines": [
                {
                  "Number": 122,
                  "Content": "resource \"aws_lb\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_lb\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  internal           = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minternal\u001b[0m           = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 136,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_lb.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 122,
                  "EndLine": 137
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0077",
          "AVDID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.\n",
          "Message": "Instance has very low backup retention period.",
          "Namespace": "builtin.aws.rds.aws0077",
          "Query": "data.builtin.aws.rds.aws0077.deny",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 106,
            "EndLine": 106,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "  backup_retention_period = 0  # Should be \u003e 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mbackup_retention_period\u001b[0m = \u001b[38;5;37m0\u001b[0m\u001b[38;5;239m  # Should be \u003e 0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 109,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_db_instance.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 110
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0080",
          "AVDID": "AVD-AWS-0080",
          "Title": "RDS encryption has not been enabled at a DB Instance level.",
          "Description": "Encryption should be enabled for an RDS Database instances.\nWhen enabling encryption by setting the kms_key_id.\n",
          "Message": "Instance does not have storage encryption enabled.",
          "Namespace": "builtin.aws.rds.aws0080",
          "Query": "data.builtin.aws.rds.aws0080.deny",
          "Resolution": "Enable encryption for RDS instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0080",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0080"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 97,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  storage_encrypted = false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mstorage_encrypted\u001b[0m = \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;239m  # Should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 109,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_db_instance.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 110
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "Public access block does not block public ACLs",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 36,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  bucket = aws_s3_bucket.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.example.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  block_public_acls       = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 37,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 33,
                  "EndLine": 40
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "Public access block does not block public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  bucket = aws_s3_bucket.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.example.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  block_public_policy     = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 33,
                  "EndLine": 40
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"trivy-test-bucket-${random_id.bucket_suffix.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"trivy-test-bucket-\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.bucket_suffix.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"trivy-test-bucket-${random_id.bucket_suffix.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"trivy-test-bucket-\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.bucket_suffix.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"trivy-test-bucket-${random_id.bucket_suffix.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"trivy-test-bucket-\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.bucket_suffix.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "Public access block does not ignore public ACLs",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 38,
            "EndLine": 38,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  bucket = aws_s3_bucket.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.example.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 39,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 33,
                  "EndLine": 40
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0092",
          "AVDID": "AVD-AWS-0092",
          "Title": "S3 Buckets not publicly accessible through ACL.",
          "Description": "Buckets should not have ACLs that allow public access\n",
          "Message": "Bucket has a public ACL: \"public-read\"",
          "Namespace": "builtin.aws.s3.aws0092",
          "Query": "data.builtin.aws.s3.aws0092.deny",
          "Resolution": "Don't use canned ACLs or switch to private acl",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0092",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0092"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_acl.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 29,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 27,
                  "Content": "resource \"aws_s3_bucket_acl\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_acl\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  bucket = aws_s3_bucket.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.example.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  acl    = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245macl\u001b[0m    = \u001b[38;5;37m\"public-read\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_acl.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 27,
                  "EndLine": 30
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "Public access block does not restrict public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 39,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  bucket = aws_s3_bucket.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.example.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 33,
                  "EndLine": 40
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-egress-sgr",
          "AVDID": "AVD-AWS-0104",
          "Title": "A security group rule should not allow unrestricted egress to any IP address.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.\n",
          "Message": "Security group rule allows unrestricted egress to any IP address.",
          "Namespace": "builtin.aws.ec2.aws0104",
          "Query": "data.builtin.aws.ec2.aws0104.deny",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-egress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.allow_all",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 85,
            "EndLine": 85,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_security_group\" \"allow_all\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_all\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "egress",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 81,
                  "EndLine": 86
                }
              },
              {
                "Resource": "aws_security_group.allow_all",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 69,
                  "EndLine": 87
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.allow_all",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 78,
            "EndLine": 78,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_security_group\" \"allow_all\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_all\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]  # Should be restricted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]\u001b[38;5;239m  # Should be restricted",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "ingress",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 73,
                  "EndLine": 79
                }
              },
              {
                "Resource": "aws_security_group.allow_all",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 69,
                  "EndLine": 87
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-add-description-to-security-group-rule",
          "AVDID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.\n",
          "Message": "Security group rule does not have a description.",
          "Namespace": "builtin.aws.ec2.aws0124",
          "Query": "data.builtin.aws.ec2.aws0124.deny",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/aws-vpc-add-description-to-security-group-rule"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.allow_all",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 81,
            "EndLine": 86,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource \"aws_security_group\" \"allow_all\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_security_group\"\u001b[0m \u001b[38;5;37m\"allow_all\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  egress {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "    from_port   = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mfrom_port\u001b[0m   = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "    to_port     = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mto_port\u001b[0m     = \u001b[38;5;37m0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    protocol    = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mprotocol\u001b[0m    = \u001b[38;5;37m\"-1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    cidr_blocks = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_blocks\u001b[0m = [\u001b[38;5;37m\"0.0.0.0/0\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 87,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_security_group.allow_all",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 69,
                  "EndLine": 87
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.web",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 51,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_instance\" \"web\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_instance\"\u001b[0m \u001b[38;5;37m\"web\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    encrypted   = false  # This should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mencrypted\u001b[0m   = \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;239m  # This should be true",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 65,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "root_block_device",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 48,
                  "EndLine": 52
                }
              },
              {
                "Resource": "aws_instance.web",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 66
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.example",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"trivy-test-bucket-${random_id.bucket_suffix.hex}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"trivy-test-bucket-\u001b[0m\u001b[38;5;37m${\u001b[0mrandom_id.bucket_suffix.hex\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0133",
          "AVDID": "AVD-AWS-0133",
          "Title": "Enable Performance Insights to detect potential problems",
          "Description": "Enabling Performance insights allows for greater depth in monitoring data.\nFor example, information about active sessions could help diagose a compromise or assist in the investigation\n",
          "Message": "Instance does not have performance insights enabled.",
          "Namespace": "builtin.aws.rds.aws0133",
          "Query": "data.builtin.aws.rds.aws0133.deny",
          "Resolution": "Enable performance insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0133",
          "References": [
            "https://aws.amazon.com/rds/performance-insights/",
            "https://avd.aquasec.com/misconfig/avd-aws-0133"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 90,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  identifier     = \"trivy-test-db\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245midentifier\u001b[0m     = \u001b[38;5;37m\"trivy-test-db\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  engine         = \"mysql\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine\u001b[0m         = \u001b[38;5;37m\"mysql\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  engine_version = \"8.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine_version\u001b[0m = \u001b[38;5;37m\"8.0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  instance_class = \"db.t3.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_class\u001b[0m = \u001b[38;5;37m\"db.t3.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  allocated_storage = 20",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mallocated_storage\u001b[0m = \u001b[38;5;37m20",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  storage_encrypted = false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mstorage_encrypted\u001b[0m = \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;239m  # Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_subnet.public1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 154,
            "EndLine": 154,
            "Code": {
              "Lines": [
                {
                  "Number": 150,
                  "Content": "resource \"aws_subnet\" \"public1\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public1\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "  vpc_id                  = aws_vpc.main.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 152,
                  "Content": "  cidr_block              = \"10.0.1.0/24\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.1.0/24\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 153,
                  "Content": "  availability_zone       = \"us-east-1a\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"us-east-1a\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 155,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "  tags = {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "    Name = \"Public Subnet 1\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"Public Subnet 1\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public1",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 150,
                  "EndLine": 159
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_subnet.public2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 165,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 161,
                  "Content": "resource \"aws_subnet\" \"public2\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"public2\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 162,
                  "Content": "  vpc_id                  = aws_vpc.main.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mvpc_id\u001b[0m                  = aws_vpc.main.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 163,
                  "Content": "  cidr_block              = \"10.0.2.0/24\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m              = \u001b[38;5;37m\"10.0.2.0/24\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 164,
                  "Content": "  availability_zone       = \"us-east-1b\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mavailability_zone\u001b[0m       = \u001b[38;5;37m\"us-east-1b\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 165,
                  "Content": "  map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 166,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 167,
                  "Content": "  tags = {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 168,
                  "Content": "    Name = \"Public Subnet 2\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"Public Subnet 2\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 170,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.public2",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 161,
                  "EndLine": 170
                }
              }
            ],
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0176",
          "AVDID": "AVD-AWS-0176",
          "Title": "RDS IAM Database Authentication Disabled",
          "Description": "Ensure IAM Database Authentication is enabled for RDS database instances to manage database access",
          "Message": "Instance does not have IAM Authentication enabled",
          "Namespace": "builtin.aws.rds.aws0176",
          "Query": "data.builtin.aws.rds.aws0176.deny",
          "Resolution": "Modify the PostgreSQL and MySQL type RDS instances to enable IAM database authentication.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0176",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/iam-auth.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0176"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 90,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  identifier     = \"trivy-test-db\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245midentifier\u001b[0m     = \u001b[38;5;37m\"trivy-test-db\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  engine         = \"mysql\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine\u001b[0m         = \u001b[38;5;37m\"mysql\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  engine_version = \"8.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine_version\u001b[0m = \u001b[38;5;37m\"8.0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  instance_class = \"db.t3.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_class\u001b[0m = \u001b[38;5;37m\"db.t3.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  allocated_storage = 20",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mallocated_storage\u001b[0m = \u001b[38;5;37m20",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  storage_encrypted = false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mstorage_encrypted\u001b[0m = \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;239m  # Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0177",
          "AVDID": "AVD-AWS-0177",
          "Title": "RDS Deletion Protection Disabled",
          "Description": "Ensure deletion protection is enabled for RDS database instances.",
          "Message": "Instance does not have Deletion Protection enabled",
          "Namespace": "builtin.aws.rds.aws0177",
          "Query": "data.builtin.aws.rds.aws0177.deny",
          "Resolution": "Modify the RDS instances to enable deletion protection.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0177",
          "References": [
            "https://aws.amazon.com/about-aws/whats-new/2018/09/amazon-rds-now-provides-database-deletion-protection/",
            "https://avd.aquasec.com/misconfig/avd-aws-0177"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 90,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "  identifier     = \"trivy-test-db\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245midentifier\u001b[0m     = \u001b[38;5;37m\"trivy-test-db\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  engine         = \"mysql\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine\u001b[0m         = \u001b[38;5;37m\"mysql\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  engine_version = \"8.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mengine_version\u001b[0m = \u001b[38;5;37m\"8.0\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  instance_class = \"db.t3.micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245minstance_class\u001b[0m = \u001b[38;5;37m\"db.t3.micro\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  allocated_storage = 20",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mallocated_storage\u001b[0m = \u001b[38;5;37m20",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  storage_encrypted = false  # Should be true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mstorage_encrypted\u001b[0m = \u001b[38;5;166mfalse\u001b[0m\u001b[38;5;239m  # Should be true",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 99,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_vpc.main",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 140,
            "EndLine": 148,
            "Code": {
              "Lines": [
                {
                  "Number": 140,
                  "Content": "resource \"aws_vpc\" \"main\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"main\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "  cidr_block           = \"10.0.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mcidr_block\u001b[0m           = \u001b[38;5;37m\"10.0.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "  enable_dns_hostnames = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 143,
                  "Content": "  enable_dns_support   = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245menable_dns_support\u001b[0m   = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 144,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "    Name = \"trivy-test-vpc\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"trivy-test-vpc\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            },
            "RenderedCause": {}
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0180",
          "AVDID": "AVD-AWS-0180",
          "Title": "RDS Publicly Accessible",
          "Description": "Ensures RDS instances and RDS Cluster instances are not launched into the public cloud.",
          "Message": "Instance has Public Access enabled",
          "Namespace": "builtin.aws.rds.aws0180",
          "Query": "data.builtin.aws.rds.aws0180.deny",
          "Resolution": "Remove the public endpoint from the RDS instance.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0180",
          "References": [
            "http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0180"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.example",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 109,
            "EndLine": 109,
            "Code": {
              "Lines": [
                {
                  "Number": 90,
                  "Content": "resource \"aws_db_instance\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_db_instance\"\u001b[0m \u001b[38;5;37m\"example\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  publicly_accessible = true  # Should be false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mpublicly_accessible\u001b[0m = \u001b[38;5;166mtrue\u001b[0m\u001b[38;5;239m  # Should be false",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 110,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_db_instance.example",
                "Filename": "terraform/main.tf",
                "Location": {
                  "StartLine": 90,
                  "EndLine": 110
                }
              }
            ],
            "RenderedCause": {}
          }
        }
      ]
    }
  ]
}
